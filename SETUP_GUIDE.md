# コエモジ∞ セットアップガイド（Windows環境用）

このガイドでは、Windows PCに「コエモジ∞」アプリケーションをセットアップする手順を説明します。
※本アプリケーションはWindows環境でのみ動作確認を行っています。

## 目次

1. [システム要件](#システム要件)
2. [インストール手順](#インストール手順)
3. [初回起動と設定](#初回起動と設定)
4. [トラブルシューティング](#トラブルシューティング)

## システム要件

### 最小要件
- **OS**: Windows 10以上
- **CPU**: Intel Core i5、AMD Ryzen 5、または同等以上
- **メモリ**: 8GB RAM以上
- **ストレージ**: 2GB以上の空き容量
- **インターネット接続**: 初回起動時にWhisperモデルをダウンロードするために必要

### 推奨環境
- **OS**: Windows 11
- **CPU**: Intel Core i7/i9、AMD Ryzen 7/9、または同等以上
- **メモリ**: 16GB RAM以上
- **GPU**: NVIDIA GeForce RTX（CUDA対応）
- **ストレージ**: SSD 5GB以上の空き容量
- **インターネット接続**: 高速接続

## インストール手順

### 1. Pythonのインストール

1. [Python公式サイト](https://www.python.org/downloads/windows/)から最新のPython 3.8以降をダウンロード
2. インストーラーを実行し、「Add Python to PATH」オプションを必ずチェック
3. 「Install Now」をクリックしてインストール

### 2. コエモジ∞のダウンロード

1. [リリースページ](https://github.com/yourusername/koemoji-infinity/releases)から最新版をダウンロード
   - ZIPファイルをダウンロードして適当なフォルダに解凍
   - または、以下のコマンドでリポジトリをクローン:
   ```
   git clone https://github.com/yourusername/koemoji-infinity.git
   ```

### 3. FFmpegのインストール

コエモジ∞は音声・動画処理にFFmpegを使用します。以下の手順でインストールしてください：

1. [FFmpegのダウンロードページ](https://ffmpeg.org/download.html)から「Windows Builds」をクリック
2. 「essentials build」をダウンロード
3. ダウンロードしたZIPファイルを解凍
4. 解凍したフォルダ内の「bin」ディレクトリにあるファイルを、システムの「PATH」に追加
   - 「コントロールパネル」→「システム」→「システムの詳細設定」→「環境変数」
   - 「Path」を選択し、「編集」をクリック
   - 「新規」をクリックして、FFmpegのbinフォルダのパスを追加（例：`C:\ffmpeg\bin`）
   - 「OK」をクリックして閉じる

### 4. 依存パッケージのインストール

コマンドプロンプトまたはPowerShellを開き、コエモジ∞のフォルダに移動して以下のコマンドを実行：

```
pip install -r requirements.txt
```

### 5. ショートカットの作成（オプション）

デスクトップショートカットを作成するには、以下の手順で実行：

1. コエモジ∞のフォルダに移動
2. `create_shortcut.py`をダブルクリックまたはコマンドプロンプトで実行：
   ```
   python create_shortcut.py
   ```
3. デスクトップに「音声文字起こしアプリ」のショートカットが作成されます

## 初回起動と設定

### 1. アプリケーションの起動方法

以下のいずれかの方法でアプリケーションを起動できます：

- 作成したデスクトップショートカットをダブルクリック
- コエモジ∞のフォルダで `run_app.bat` をダブルクリック
- コマンドプロンプトでコエモジ∞のフォルダに移動し、`python main.py` を実行

### 2. 初回起動時の処理

初回起動時、以下の処理が自動的に行われます：

- 必要なフォルダの作成
- デフォルト設定の生成
- Whisperモデルのダウンロード（インターネット接続が必要）

> **注意**: 初回起動時はWhisperモデルのダウンロードに時間がかかることがあります（特に「large」モデルの場合）。

### 3. 基本設定

1. アプリケーション起動後、右上の「⚙」アイコンをクリックして設定画面を開きます
2. 必要に応じて以下の設定を変更します：

#### モデル設定
- **モデルサイズ**: 精度と速度のバランスに応じて選択
  - 一般的には「small」または「medium」が推奨
  - GPUを搭載したPCでは「large」も高速に処理可能
  - 低スペックPCでは「tiny」または「base」を選択

#### 言語設定
- **言語**: 文字起こしを行う主な言語を選択
  - 日本語コンテンツが多い場合は「日本語」を選択
  - 複数言語が混在する場合は「自動検出」を選択

#### 出力設定
- **出力先**: 文字起こし結果を保存するフォルダを選択
- **タイムスタンプ**: 音声の区切りごとにタイムコードを表示するかどうか

### 4. 文字起こしの実行

1. 「ファイル追加」ボタンをクリックして音声・動画ファイルを選択
2. 複数ファイルを一度に追加することも可能
3. 「文字起こし開始」ボタンをクリックして処理を開始
4. 処理が完了すると結果が表示され、保存オプションが提示されます

## トラブルシューティング

### 一般的な問題と解決策

#### FFmpeg関連のエラー
- **エラーメッセージ**: `FFmpegが見つかりません`
- **解決策**: 
  1. FFmpegが正しくインストールされているか確認
  2. システムの環境変数「Path」にFFmpegのbinフォルダが追加されているか確認
  3. PCの再起動を試行

#### モデルダウンロードの問題
- **エラーメッセージ**: `モデルのロードに失敗しました`
- **解決策**:
  1. インターネット接続を確認
  2. ファイアウォールやウイルス対策ソフトが通信をブロックしていないか確認
  3. 一時的な問題の場合は、アプリを再起動して再試行

#### メモリ不足エラー
- **エラーメッセージ**: `メモリエラー`や`CUDA out of memory`
- **解決策**:
  1. より小さいモデルサイズ（tiny、baseなど）を選択
  2. バックグラウンドで実行中の他のアプリケーションを閉じる
  3. 長い音声ファイルの場合、小さなセグメントに分割して処理

#### 処理速度が遅い
- **問題**: 文字起こし処理に長時間かかる
- **解決策**:
  1. より小さいモデルサイズを選択
  2. GPU搭載のPCを使用（可能な場合）
  3. 短い音声ファイルから試す

#### Python関連のエラー
- **エラーメッセージ**: `'python' は、内部コマンドまたは外部コマンド...として認識されていません`
- **解決策**:
  1. Pythonが正しくインストールされているか確認
  2. システムの環境変数「Path」にPythonのインストールパスが追加されているか確認
  3. PCの再起動を試行

### サポートの利用

さらに支援が必要な場合は、以下の方法でサポートを受けられます：

- [GitHub Issues](https://github.com/yourusername/koemoji-infinity/issues)で問題を報告
- メールでのサポート: support@example.com

---

**注意**: 本アプリケーションは現在Windows環境でのみ動作確認を行っています。macOSやLinux環境での動作は保証されていません。 